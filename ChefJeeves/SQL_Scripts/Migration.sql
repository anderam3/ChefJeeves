USE `chefjeeves`;
SET FOREIGN_KEY_CHECKS=1;

DROP TABLE IF EXISTS `AccountRecipe`;
DROP TABLE IF EXISTS `RecipeIngredient`;
DROP TABLE IF EXISTS `AccountIngredient`;
DROP TABLE IF EXISTS `Recipe`;
DROP TABLE IF EXISTS `Measurement`;
DROP TABLE IF EXISTS `Account`;
DROP TABLE IF EXISTS `Ingredient`;


CREATE TABLE `account` (
	`USERNAME` varchar(64) NOT NULL,
	`EMAIL` varchar(64) NOT NULL,
	`FULL_NAME` varchar(64) NOT NULL,
	`PHONE` int(64) DEFAULT NULL,
	`SECURITY_QUESTION` varchar(512) NOT NULL,
	`SECURITY_ANSWER` varchar(512) NOT NULL,
	`PASSCODE` varchar(512) NOT NULL,
	`SALT` float NOT NULL,
	`IS_ACTIVE_USER` tinyint(1) NOT NULL,
  PRIMARY KEY (`USERNAME`,`EMAIL`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `Recipe` (
	`RECIPE_ID` int(11) NOT NULL AUTO_INCREMENT,
	`RECIPE_NAME` varchar(64) NOT NULL,
	`PREPARATION` text NOT NULL,
  PRIMARY KEY (`RECIPE_ID`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `AccountRecipe` (
	`USERNAME` varchar(64) NOT NULL,
	`RECIPE_ID` int(11) NOT NULL,
	PRIMARY KEY (`USERNAME`,`RECIPE_ID`),
	CONSTRAINT `AccountRecipe_USERNAME` FOREIGN KEY (`USERNAME`) REFERENCES `Account` (`USERNAME`) ON DELETE NO ACTION ON UPDATE NO ACTION,
	CONSTRAINT `AccountRecipe_RECIPE_ID` FOREIGN KEY (`RECIPE_ID`) REFERENCES `Recipe` (`RECIPE_ID`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `Ingredient` (
	`INGREDIENT_NAME` varchar(64) NOT NULL,
	PRIMARY KEY (`INGREDIENT_NAME`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `Measurement` (
	`UNIT_ABBREVIATION` varchar(64) NOT NULL,
	`UNIT_NAME` varchar(64) NOT NULL,
	PRIMARY KEY (`UNIT_ABBREVIATION`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `RecipeIngredient` (
	`RECIPE_ID` int(11) NOT NULL,
	`INGREDIENT_NAME` varchar(64) NOT NULL,
	`QUANTITY` float NOT NULL,
	`UNIT_ABBREVIATION` varchar(64),
	PRIMARY KEY (`RECIPE_ID`,`INGREDIENT_NAME`),
	CONSTRAINT `RecipeIngredient_RECIPE_ID` FOREIGN KEY (`RECIPE_ID`) REFERENCES `Recipe` (`RECIPE_ID`) ON DELETE NO ACTION ON UPDATE NO ACTION,
	CONSTRAINT `RecipeIngredient_INGREDIENT_NAME` FOREIGN KEY (`INGREDIENT_NAME`) REFERENCES `Ingredient` (`INGREDIENT_NAME`) ON DELETE NO ACTION ON UPDATE NO ACTION,
	CONSTRAINT `RecipeIngredient_UNIT_ABBREVIATION` FOREIGN KEY (`UNIT_ABBREVIATION`) REFERENCES `Measurement` (`UNIT_ABBREVIATION`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `AccountIngredient` (
	`USERNAME` varchar(64) NOT NULL,
	`INGREDIENT_NAME` varchar(64) NOT NULL,
	PRIMARY KEY (`USERNAME`,`INGREDIENT_NAME`),
	CONSTRAINT `AccountIngredient_USERNAME` FOREIGN KEY (`USERNAME`) REFERENCES `Account` (`USERNAME`) ON DELETE NO ACTION ON UPDATE NO ACTION,
	CONSTRAINT `AccountIngredient_INGREDIENT_NAME` FOREIGN KEY (`INGREDIENT_NAME`) REFERENCES `Ingredient` (`INGREDIENT_NAME`) ON DELETE NO ACTION ON UPDATE NO ACTION
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

INSERT INTO `account` (`USERNAME`,`EMAIL`,`FULL_NAME`,`PHONE`,`SECURITY_QUESTION`,`SECURITY_ANSWER`,`PASSCODE`,`SALT`,`IS_ACTIVE_USER`) VALUES ('jsmith','john.smith@email.com','John Smith',1111111111,'Age?',23,'password',1.0,1);

INSERT INTO `ingredient`(`INGREDIENT_NAME`) VALUES ('bacon');
INSERT INTO `ingredient`(`INGREDIENT_NAME`) VALUES ('brown bean');
INSERT INTO `ingredient`(`INGREDIENT_NAME`) VALUES ('butter');
INSERT INTO `ingredient`(`INGREDIENT_NAME`) VALUES ('egg');
INSERT INTO `ingredient`(`INGREDIENT_NAME`) VALUES ('flour');
INSERT INTO `ingredient`(`INGREDIENT_NAME`) VALUES ('garlic');
INSERT INTO `ingredient`(`INGREDIENT_NAME`) VALUES ('milk');
INSERT INTO `ingredient`(`INGREDIENT_NAME`) VALUES ('olive oil');
INSERT INTO `ingredient`(`INGREDIENT_NAME`) VALUES ('orange');
INSERT INTO `ingredient`(`INGREDIENT_NAME`) VALUES ('pepper');
INSERT INTO `ingredient`(`INGREDIENT_NAME`) VALUES ('salt');
INSERT INTO `ingredient`(`INGREDIENT_NAME`) VALUES ('strawberry');
INSERT INTO `ingredient`(`INGREDIENT_NAME`) VALUES ('tomato');

INSERT INTO MEASUREMENT(UNIT_ABBREVIATION, UNIT_NAME) VALUES ('tsp', 'teaspoon');
INSERT INTO MEASUREMENT(UNIT_ABBREVIATION, UNIT_NAME) VALUES ('tbsp', 'tablespoon');
INSERT INTO MEASUREMENT(UNIT_ABBREVIATION, UNIT_NAME) VALUES ('cup', 'cup');
INSERT INTO MEASUREMENT(UNIT_ABBREVIATION, UNIT_NAME) VALUES ('oz', 'ounce');
INSERT INTO MEASUREMENT(UNIT_ABBREVIATION, UNIT_NAME) VALUES ('fl.oz', 'fluid ounce');
INSERT INTO MEASUREMENT(UNIT_ABBREVIATION, UNIT_NAME) VALUES ('pt', 'pint');
INSERT INTO MEASUREMENT(UNIT_ABBREVIATION, UNIT_NAME) VALUES ('pinch', 'pinch');
INSERT INTO MEASUREMENT(UNIT_ABBREVIATION, UNIT_NAME) VALUES ('qt', 'quart');
INSERT INTO MEASUREMENT(UNIT_ABBREVIATION, UNIT_NAME) VALUES ('gal', 'gallon');
INSERT INTO MEASUREMENT(UNIT_ABBREVIATION, UNIT_NAME) VALUES ('lb', 'pound');
INSERT INTO MEASUREMENT(UNIT_ABBREVIATION, UNIT_NAME) VALUES ('doz', 'dozen');
INSERT INTO MEASUREMENT(UNIT_ABBREVIATION, UNIT_NAME) VALUES ('pkg', 'package');
INSERT INTO MEASUREMENT(UNIT_ABBREVIATION, UNIT_NAME) VALUES ('sm', 'small');
INSERT INTO MEASUREMENT(UNIT_ABBREVIATION, UNIT_NAME) VALUES ('med', 'medium');
INSERT INTO MEASUREMENT(UNIT_ABBREVIATION, UNIT_NAME) VALUES ('lg', 'large');
INSERT INTO MEASUREMENT(UNIT_ABBREVIATION, UNIT_NAME) VALUES ('sq', 'square');
INSERT INTO MEASUREMENT(UNIT_ABBREVIATION, UNIT_NAME) VALUES ('approx', 'approximately');
INSERT INTO MEASUREMENT(UNIT_ABBREVIATION, UNIT_NAME) VALUES ('min', 'minutes');


INSERT INTO RECIPE (RECIPE_NAME, PREPARATION) 
VALUES ('Scrambled Eggs', 'BEAT eggs, milk, salt and pepper in medium bowl until blended.
HEAT butter in large nonstick skillet over medium heat until hot. POUR IN egg mixture. As eggs begin to set, GENTLY PULL the eggs across the pan with a spatula, forming large soft curds.
CONTINUE cooking – pulling, lifting and folding eggs – until thickened and no visible liquid egg remains. Do not stir constantly. REMOVE from heat. SERVE immediately.');

INSERT INTO accountrecipe(USERNAME, RECIPE_ID) VALUES ('jsmith', 1);

INSERT INTO recipeingredient(RECIPE_ID, INGREDIENT_NAME, QUANTITY) VALUES (1, 'egg', 4);
INSERT INTO recipeingredient(RECIPE_ID, INGREDIENT_NAME, QUANTITY, UNIT_ABBREVIATION) VALUES (1,'milk',0.25,'cup');
INSERT INTO recipeingredient(RECIPE_ID, INGREDIENT_NAME, QUANTITY, UNIT_ABBREVIATION) VALUES (1,'salt',1,'pinch');
INSERT INTO recipeingredient(RECIPE_ID, INGREDIENT_NAME, QUANTITY, UNIT_ABBREVIATION) VALUES (1,'pepper',1,'pinch');
INSERT INTO recipeingredient(RECIPE_ID, INGREDIENT_NAME, QUANTITY, UNIT_ABBREVIATION) VALUES (1,'butter',4,'tsp');

INSERT INTO AccountIngredient(USERNAME, INGREDIENT_NAME) VALUES ('jsmith', 'butter');
INSERT INTO AccountIngredient(USERNAME, INGREDIENT_NAME) VALUES ('jsmith', 'egg');
INSERT INTO AccountIngredient(USERNAME, INGREDIENT_NAME) VALUES ('jsmith', 'garlic');
INSERT INTO AccountIngredient(USERNAME, INGREDIENT_NAME) VALUES ('jsmith', 'olive oil');
INSERT INTO AccountIngredient(USERNAME, INGREDIENT_NAME) VALUES ('jsmith', 'milk');
INSERT INTO AccountIngredient(USERNAME, INGREDIENT_NAME) VALUES ('jsmith', 'salt');
INSERT INTO AccountIngredient(USERNAME, INGREDIENT_NAME) VALUES ('jsmith', 'pepper');